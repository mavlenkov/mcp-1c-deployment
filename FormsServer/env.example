# ============================================================================
# MCP Forms Server - Конфигурация окружения
# ============================================================================
# Скопируйте этот файл в .env и настройте параметры под вашу среду
# cp env.example .env
# ============================================================================

# ============================================================================
# ОБЯЗАТЕЛЬНЫЕ ПАРАМЕТРЫ
# ============================================================================

# Лицензионный ключ для запуска сервера (обязательный)
LICENSE_KEY=your_license_key_here

# Путь к выгрузке конфигурации 1С вашего проекта
# Пример для Windows: C:/1C/Configurations/MyProject
MAIN_REPO=C:/1C/Configurations/MyProject

# Путь к директории для баз данных (обязательный)
# Здесь будут храниться forms_knowledge.db и ChromaDB
DATABASES_PATH=C:/databases

# ============================================================================
# РЕЖИМЫ РАБОТЫ
# ============================================================================

# Индексация форм из MAIN_REPO при запуске
# true - сканировать MAIN_REPO и создать/обновить forms_knowledge.db
# false - использовать существующую базу данных (по умолчанию)
# При true требуется OPENROUTER_API_KEY для генерации описаний форм
INDEX_FORM_EXAMPLES=true

# Генерация схем форм при запуске
# true - при старте генерировать form_schema_new.xsd и form_schema.json в MAIN_REPO
# false - пропустить генерацию схем (по умолчанию)
GENERATE_FORM_SCHEMA=true

# ============================================================================
# ПАРАМЕТРЫ СЕРВЕРА
# ============================================================================

# Порт HTTP-сервера для MCP endpoint
# По умолчанию: 8011
PORT=8011

# Порт для health check endpoint (автоматически PORT + 1)
# По умолчанию: 8012
HEALTH_PORT=8012

# Тип транспорта MCP протокола
# true - Server-Sent Events (SSE) - рекомендуется для большинства случаев
# false - Streamable HTTP
USESSE=false

# ============================================================================
# ПАРАМЕТРЫ БАЗ ДАННЫХ
# ============================================================================

# Пересоздать ChromaDB при старте
# true - удалить существующую базу векторов и переиндексировать из SQLite
# false - использовать существующую базу (по умолчанию)
# Установите true если обновили forms_knowledge.db и нужно переиндексировать
RESET_DATABASE=true

# Очистить кэш моделей embeddings
# true - удалить кэшированные модели (загрузятся заново при старте)
# false - использовать кэшированные модели (по умолчанию)
RESET_CACHE=false

# ============================================================================
# ПАРАМЕТРЫ EMBEDDING API (векторные представления)
# ============================================================================

# Модель для локального fallback (если внешний API недоступен)
# По умолчанию: intfloat/multilingual-e5-small (хорошо работает с русским языком)
# Другие варианты: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
EMBEDDING_MODEL=intfloat/multilingual-e5-small

# URL API для embeddings (LM Studio, Ollama или совместимый сервис)
# Для Docker на Linux используйте host.docker.internal для доступа к хосту
# Примеры:
#   LM Studio: http://host.docker.internal:1234/v1
#   Ollama: http://host.docker.internal:11434/v1
#   OpenAI: https://api.openai.com/v1
OPENAI_API_BASE=http://host.docker.internal:1234/v1

# API ключ для внешнего сервиса embeddings
# Для LM Studio можно использовать любое значение (например: lm-studio)
# Для OpenAI используйте ваш API ключ
OPENAI_API_KEY=lm-studio

# Имя модели для внешнего API (переопределяет EMBEDDING_MODEL)
# Оставьте пустым для использования значения EMBEDDING_MODEL
# Примеры для LM Studio/Ollama: text-embedding-3-small, nomic-embed-text
OPENAI_MODEL=

# ============================================================================
# ПАРАМЕТРЫ ГЕНЕРАЦИИ БАЗЫ ДАННЫХ
# (используются только при INDEX_FORM_EXAMPLES=true)
# ============================================================================

# API ключ для OpenRouter (генерация описаний форм с помощью LLM)
# Получите ключ на https://openrouter.ai
# ОБЯЗАТЕЛЕН при INDEX_FORM_EXAMPLES=true
OPENROUTER_API_KEY=

# Базовый URL API OpenRouter
# По умолчанию: https://openrouter.ai/api/v1
OPENROUTER_API_BASE=https://openrouter.ai/api/v1

# Модель для генерации описаний форм
# Рекомендуемые модели:
#   qwen/qwen3-235b-a22b-2507 - высокое качество, поддержка русского
#   anthropic/claude-3.5-sonnet - отличное качество
#   google/gemini-pro - хорошее соотношение цена/качество
OPENROUTER_MODEL=qwen/qwen3-235b-a22b-2507

# Задержка между API-запросами в секундах
# Увеличьте при превышении rate limits API
# По умолчанию: 1.0
API_DELAY=1.0

# ============================================================================
# ЛОГИРОВАНИЕ
# ============================================================================

# Уровень логирования
# Варианты: DEBUG, INFO, WARNING, ERROR
# DEBUG - максимальная детализация (для отладки)
# INFO - стандартный уровень (по умолчанию)
# WARNING - только предупреждения и ошибки
# ERROR - только ошибки
LOG_LEVEL=INFO