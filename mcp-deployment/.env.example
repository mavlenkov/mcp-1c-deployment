# ============================================================================
# MCP СЕРВЕРЫ ДЛЯ 1C:ENTERPRISE - ЕДИНАЯ КОНФИГУРАЦИЯ
# ============================================================================
# Скопируйте этот файл в .env и заполните необходимые параметры
# cp .env.example .env
# ============================================================================

# ============================================================================
# ПУТИ К ДАННЫМ (все данные в одном каталоге)
# ============================================================================
# Корневая директория для всех данных MCP серверов
DATA_DIR=/opt/mcp-data

# Путь к отчету по метаданным 1С (.txt файлы)
# Получается через "Конфигурация - отчет из конфигурации"
METADATA_HOST_PATH=${DATA_DIR}/report

# Путь к детальным файлам метаданных (опционально)
# Используется для обогащения метаданных (выгрузка конфигурации в файлы)
METADATA_FILES_HOST_PATH=${DATA_DIR}/files

# Путь к выгрузке конфигурации 1С (файлы кода)
# Получается через "Конфигурация - выгрузить конфигурацию в файлы"
CODE_PATH=${DATA_DIR}/files

# Путь к справке БСП (для SSLSearchServer)
# Скачивается с сайта 1С или репозитория БСП
SSL_PATH=${DATA_DIR}/ssl

# Путь к шаблонам кода (для TemplatesSearchServer)
# Можно скачать с https://fastcode.im/Templates
TEMPLATES_PATH=${DATA_DIR}/templates

# Путь к выгрузке расширений конфигурации (опционально)
# Экспортируется из Конфигуратора: Конфигурация → Расширения → Выгрузить в файлы
# Каждое расширение — в отдельном подкаталоге
EXTENSIONS_PATH=${DATA_DIR}/extensions

# Путь к данным FormsServer (базы форм)
# Создаётся автоматически при первом запуске
FORMS_PATH=${DATA_DIR}/forms
MAIN_REPO=${DATA_DIR}/files
DATABASES_PATH=${DATA_DIR}/forms_db

# Путь к платформе 1С на хосте (обязательно для HelpSearchServer)
# Linux: /opt/1cv8/x86_64/8.3.27.1859
# Windows: C:/Program Files/1cv8/8.3.23.1997/bin
1C_BIN_PATH=/opt/1cv8/x86_64/8.3.27.1859

# ============================================================================
# OPENAI API / EMBEDDINGS (OpenRouter для всех сервисов)
# ============================================================================
# Получите ключ на https://openrouter.ai
OPENAI_API_KEY=your_openrouter_key_here
OPENAI_API_BASE=https://openrouter.ai/api/v1

# Модель для генерации текста
OPENAI_MODEL=openai/gpt-4o-mini

# Модель для векторных представлений (embeddings)
OPENAI_EMBEDDING_MODEL=qwen/qwen3-embedding-8b

# ============================================================================
# NEO4J КОНФИГУРАЦИЯ (для Graph_metadata_search)
# ============================================================================
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=your_neo4j_password_here
NEO4J_DATABASE=neo4j

# ============================================================================
# LICENCE KEYS
# ============================================================================
LICENSE_KEY_GRAPH=your_license_key_here
LICENSE_KEY_FORMS=your_license_key_here
LICENSE_KEY_DOCS=your_license_key_here
LICENSE_KEY_SYNTAX=your_license_key_here
LICENSE_KEY_METADATA=your_license_key_here
LICENSE_KEY_SSL=your_license_key_here
LICENSE_KEY_TEMPLATES=your_license_key_here
LICENSE_KEY_CODECHECKER=your_license_key_here
LICENSE_KEY_CLOUD=your_license_key_here

# ============================================================================
# ДРУГИЕ ПАРАМЕТРЫ
# ============================================================================
# Версия БСП для справки
SSL_VERSION=3.1.11

# API ключ 1С:Напарник (для 1CCodeChecker)
# Получите у партнёра 1С
ONEC_AI_TOKEN=your_onec_ai_token_here

# Тип транспорта MCP (false=Streamable HTTP, true=SSE для legacy клиентов)
USESSE=false

# ============================================================================
# FORMSSERVER ПАРАМЕТРЫ
# ============================================================================
# Индексация форм при запуске
INDEX_FORM_EXAMPLES=true

# Генерация схем форм при запуске
GENERATE_FORM_SCHEMA=true

# Пересоздать базы при старте
RESET_DATABASE=false

# Очистить кэш моделей
RESET_CACHE=false

# OpenRouter настройки для FormsServer
OPENROUTER_API_KEY=${OPENAI_API_KEY}
OPENROUTER_API_BASE=${OPENAI_API_BASE}
OPENROUTER_MODEL=qwen/qwen3-235b-a22b-2507

# ============================================================================
# CLOUD EMBEDDINGS SERVER ПАРАМЕТРЫ
# ============================================================================
# Провайдер embeddings: openrouter, openai, cohere, jina, local
EMBEDDING_PROVIDER=openrouter

# API ключ OpenRouter (используется OPENAI_API_KEY если провайдер openrouter)
OPENROUTER_API_KEY=${OPENAI_API_KEY}

# Параллельность индексации (1 = последовательно, 10 = быстрее, риск rate-limit)
EMBEDDING_CONCURRENCY=10

# Количество текстов в одном API-запросе
EMBEDDING_BATCH_SIZE=10

# Автоиндексация при запуске
AUTO_INDEX=true

# Путь к исходным файлам для индексации
CLOUD_SOURCE_PATH=${CODE_PATH}

# Путь к векторной БД CloudEmbeddingsServer
CLOUD_CHROMA_PATH=${DATA_DIR}/cloud_embeddings_db

# ============================================================================
# GRAPH METADATA ПАРАМЕТРЫ
# ============================================================================
# Embedding API (отдельно от основного OpenAI, если нужен другой провайдер)
# По умолчанию наследует OPENAI_API_KEY/OPENAI_API_BASE
# OPENAI_EMBEDDING_API_KEY=${OPENAI_API_KEY}
# OPENAI_EMBEDDING_API_BASE=${OPENAI_API_BASE}
# OPENAI_EMBEDDING_MODEL=text-embedding-ada-002

# Температура и макс. токенов для LLM запросов graph server
OPENAI_TEMPERATURE=0.1
OPENAI_MAX_COMPLETION_TOKENS=2000

# Генерировать AI-описания для метаданных
CALCULATE_BUSINESS_INFO=true

# Режим отладки
DEBUG=false

# Название проекта
PROJECT_NAME=1C Metadata Project

# Семантический поиск по бизнес-описаниям
ENABLE_BUSINESS_SEARCH=true

# Автоматическое обновление индексов при запуске
AUTO_UPDATE_ON_STARTUP=true

# Асинхронная индексация векторов
ASYNC_VECTOR_INDEXING=true
